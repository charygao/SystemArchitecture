## 4.1 网络架构与协议

网络架构是指计算机网络的各层及其协议的集合

协议是指用于规定信息的格式及如何发送和接收信息的一套规则

### 4.1.1网络互联模型

OSI/RM 七层：物理层、数据链路层、网络层、传输层、会话层、表示层、应用层

**1.各层的功能**

物理层：透明地完成相邻节点之间原始比特流的传输

数据链路层：负责在两个相邻节点之间的线路上无差错地传送以帧为单位的数据

网络层：是通信子网的最高层。负责在数据链路层服务的基础上，实现整个通信子网内的连接，并通过网络连接交换网络服务数据单元

传输层：负责数据通信的最高层，是面向网络通信的低三层（物理层、数据链路层和网络层）和面向信息处理的高三层（会话层、表示层和应用层）之间的中间层，是资源子网和通信子网的桥梁，主要任务是为两台计算机的通信提供可靠的端到端的数据传输服务。

会话层：利用传输层提供的端到端数据传输服务，具体实施服务请求者与服务提供者之间的通信、组织和同步它们的会话活动，并管理它们的数据交换过程。

表示层：处理的是用户信息的表示问题。

应用层：直接面向用户的一层，是计算机网络与最终用户之间的界面

**2.TCP/IP结构模型**

网络接口层：对应七层中的数据链路层和物理层，只定义了网络接口层作为物理层的接口规范。处在最底层，主要负责为物理网络准备数据所需的全部服务程序和功能。

网络互联层，也称网络层，负责将数据报独立地从信源传送到信宿，主要解决路由选择、阻塞控制和网络互联等问题，在功能上类似七层中的网络层。

传输层：负责在信源和信宿之间提供端到端的数据传输服务，相当于七层中的传输层

应用层：直接面向用户应用，魏永福方便的提供对各种网络资源的访问服务，包含了七层中的会话层和表示层中的部分功能

### 4.1.2 常见的网络协议

#### 1.应用层协议

**FTP**：文件传输协议，是网络上两台计算机传送文件的协议，运行在TCP上，传输模式包括Bin（二进制）和ASII（文本文件）两种，除了文本文件之外，都应该使用二进制模式传输。在客户机和服务器之间建立两条TCP连接，一条用于传送控制信息（使用21号端口），另一条用于传送文件内容（使用20端口）。

**TFTP**：简单文本传输协议，提供不复杂、开销不大的文件传输服务。建立在TDP上，提供不可靠的数据流传输服务，不提供存取授权与认证机制，使用超时重传的方式来保证数据的到达

**HTTP**：超文本传输协议，是用于从www服务器传输超文本到本地浏览器的传送协议。可以使浏览器更加高效，使网络传输减少。建立在TCP上，不仅保证计算机正确快速地传输超文本文档，还确定稳当的哪一部分，哪部分内容首先显示等。

**SMTP**：简单邮件传输协议，建立在TCP上，是一种提供可靠且有效的电子邮件传输的协议。是建模在FTP文件传输服务上的一种邮件服务，主要用于传输系统之间的邮件信息，并提供与电子邮件有关的通知。

**DHCP**：动态主机配置协议，建立在UDP上，是基于客户机/服务器模型设计的。所有的IP网络设定数据都由DHCP服务器集中管理，并负责处理客户端的DHCP要求；而客户端则会使用从服务器分配下来的IP环境数据。DHCP通过租约的概念，有效且动态地分配客户端的TCP/IP设定。分配IP地址有三种方式：固定分配，动态分配，自动分配

**Telnet**：远程登录协议，是登录和仿真程序，建立在TCP上，基本功能是允许用户登录进入远程计算机系统。

**DNS**：域名系统，是进行域名解析的服务器

**SNMP**：简单网络管理协议，是指一系列网络管理规范的集合，包括协议本身、数据结构的定义和一些相关概念

#### 2. 传输层协议

**TCP**：在IP协议提供的不可靠数据服务的基础上，采用了重发技术，为应用程序提供了一个可靠的、面向连接的、全双工的数据传输服务。一般用于传输数据量比较少，且对可靠性要求高的场合。

**UDP**：是一种不可靠的、无连接的协议，可以保证应用程序进程间的通信，与TCP相比，是一种无连接的协议，错误检测功能要弱得多。一般用于传输量大，对可靠性要求不是很高，但要求速度快的场合

#### 3.网络层协议

**IP**：提供的服务通常被认为是无连接的和不可靠的，将差错检测和流量控制之类的服务授权给了其他的各层协议，这正是TCP/IP能够高效率工作的一个重要保证。

**ARP**：地址解析协议，用于动态地完成IP地址向物理地址（MAC地址）的转换。

**ICMP**：网际控制报文协议，用于发送差错报文的协议，功能在于尽量避免差错，并在发生差错时报告的机制

**IGMP**：网际组管理协议，是计算机用作向相邻多目路由器报告多目组成员的协议。

### 4.1.3 IPv6

为了应对IPv4的缺点，地址空间耗尽，路由表急剧膨胀，缺乏对QoS的支持，本身不提供任何安全机制，移动性能差等问题

#### 1.IPv6 地址表示

一个32位的IPv4地址以8个位为一段分为4段，每段之间用“.”分开。而IPv6地址的128位是以16位为一段，共分为8段，每段的16位转换为一个4位的16进制数字，每段之间用冒号“：”分开。

有三种格式来表示，首选格式是最长的表示方法，由所有的32个16进制字符组成。

先由128位2进制字符，16位一段分割，每段4位得到一个16进制字符，然后冒号隔开，得到

2001：0da8：d001：0001：0000：0000：0000：0001

#### 2.压缩地址表示

每段地址中去除前导0，连续2段以上为0的字段使用“：：”来表示

2001：da8：d001：1：：1

3.内嵌